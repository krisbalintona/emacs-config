#+TITLE: Quality of life packages

* Helpful

Have more descriptive and helpful function and variable descriptions
#+BEGIN_SRC emacs-lisp
  (use-package helpful
    :after (evil evil-collection)
    :demand t ; Don't wait for the binded keys
    :bind
    ;; Remap all default help commands to helpful
    ([remap describe-function] . helpful-function)
    ([remap describe-command] . helpful-command)
    ([remap describe-variable] . helpful-variable)
    ([remap describe-key] . helpful-key)
    :custom
    ;; Make counsel use helpful
    (counsel-describe-function-function #'helpful-callable)
    (counsel-describe-variable-function #'helpful-variable)

    :config
    (evil-define-key '(visual normal) 'global (kbd "K") 'helpful-at-point)

    (kb/leader-keys
      "hk" '(helpful-key :which-key "Desc key")
      )
    )
#+END_SRC


* Beacon

Cool version of nav-flash
#+BEGIN_SRC emacs-lisp
  (use-package beacon
    :custom
    (beacon-blink-when-focused t) ; Blink when Emacs comes into focus
    (beacon-blink-delay 0.04)
    (beacon-blink-duration 0.5)
    :config
    (beacon-mode)
    )
#+END_SRC
* Saveplace

Save and restore point in files
#+BEGIN_SRC emacs-lisp
  (use-package saveplace
    :config
    (save-place-mode)
    )
#+END_SRC
* Which-key

Show keybinds
#+BEGIN_SRC emacs-lisp
  (use-package which-key
    :hook (after-init . which-key-mode)
    :custom
    (which-key-idle-delay 0.85)
    (which-key-show-early-on-C-h t) ; Show which-key immediately for C-h
    (which-key-add-column-padding 0)
    (which-key-max-display-columns nil)
    :init
    (which-key-setup-side-window-right) ; Show which-key on the right
    :config
    ;; Don't display C-u, digit, and other numeric keybad bindings
    (push '(("^[0-9-]\\|kp-[0-9]\\|kp-subtract\\|C-u$" . nil) . ignore) 
          which-key-replacement-alist)
    )
#+END_SRC

* All-the-icons

#+BEGIN_SRC emacs-lisp
(use-package all-the-icons)
#+END_SRC
* Hide-mode-line

Hide the modeline when you don't want to see it
#+BEGIN_SRC emacs-lisp
  (use-package hide-mode-line)
#+END_SRC

* Super-save

Automatically save buffers when you do certain things
#+BEGIN_SRC emacs-lisp
  (use-package super-save
    :hook (after-init . super-save-mode)
    :custom
    (super-save-auto-save-when-idle t) ; Save buffer if Emacs is idle
    (super-save-idle-duration 10) ; Wait 10 seconds for idle trigger
    (super-save-remote-files t) ; Turn on saving of remote files (those pulled from git repo?)
    (super-save-exclude nil) ; Don't exclude anything from being saved
    :config
    (add-to-list 'super-save-triggers 'evil-window-next)
    (add-to-list 'super-save-hook-triggers 'eyebrowse-pre-window-switch-hook)
    )
#+END_SRC

* Autorevert

#+BEGIN_SRC emacs-lisp
  (use-package autorevert
    :custom
    (auto-revert-interval 7)
    (auto-revert-check-vc-info t)
    (global-auto-revert-non-file-buffers t)
    (auto-revert-verbose t)
    :config
    (global-auto-revert-mode t)
    )
#+END_SRC

* Whitespace

Remove whitespace on save
#+BEGIN_SRC emacs-lisp
  (use-package whitespace
    :hook (before-save . whitespace-cleanup)
    :custom
    (whitespace-style '(face empty indentation::space tab))
    )
#+END_SRC

* Rainbow-delimiters

Color-code your parentheses
#+BEGIN_SRC emacs-lisp
  (use-package rainbow-delimiters
    :hook (prog-mode . rainbow-delimiters-mode)
    )
#+END_SRC
* Unicode-fonts

#+BEGIN_SRC emacs-lisp
  (use-package unicode-fonts
    :preface
    (defun dw/replace-unicode-font-mapping (block-name old-font new-font)
      "Taken from https://github.com/daviwil/dotfiles/blob/master/Emacs.org#startup-performance"
      (let* ((block-idx (cl-position-if
                         (lambda (i) (string-equal (car i) block-name))
                         unicode-fonts-block-font-mapping))
             (block-fonts (cadr (nth block-idx unicode-fonts-block-font-mapping)))
             (updated-block (cl-substitute new-font old-font block-fonts :test 'string-equal)))
        (setf (cdr (nth block-idx unicode-fonts-block-font-mapping))
              `(,updated-block))))
    :custom
    (unicode-fonts-skip-font-groups '(low-quality-glyphs))
    :preface
    (defun kb/fix-unicode-fonts ()
      "Fix the font mappings to use the right emoji font"
      (mapcar
       (lambda (block-name)
         (dw/replace-unicode-font-mapping block-name "Apple Color Emoji" "Noto Color Emoji"))
       '("Dingbats"
         "Emoticons"
         "Miscellaneous Symbols and Pictographs"
         "Transport and Map Symbols"))

      (unicode-fonts-setup)
      )
    :config
    (if (daemonp) ; Hooks depending on daemon or not
        (add-hook 'server-after-make-frame-hook 'kb/fix-unicode-fonts)
      (add-hook 'window-setup-hook 'kb/fix-unicode-fonts))
    )
#+END_SRC

* Emojify

Show emojiis
#+BEGIN_SRC emacs-lisp
  (use-package emojify
    :custom
    (global-emojify-mode t)
    )
#+END_SRC
* Pinetry

Emacs can be prompted for the PIN of GPG private keys, we just need to set epa-pinentry-mode to accomplish that:
- Doom has this settings as well
#+BEGIN_SRC emacs-lisp
  (setq epg-pinentry-mode 'loopback)
  ;; (pinentry-start) ; This function doesn't exist?
#+END_SRC
* Anzu

Highlight indicators during replace and regexp
#+begin_src emacs-lisp
  (use-package anzu
    :hook (after-init . global-anzu-mode)
    :custom
    (anzu-cons-mode-line-p nil)

    (general-define-key [remap query-replace] 'anzu-query-replace-regexp)
    )
#+end_src
* Expand-region

Incrementally select a region outward
#+begin_src emacs-lisp
  (use-package expand-region
    :config
    (general-define-key
     :keymaps '(normal motion visaul)
     "ge" 'er/expand-region)
    )
#+end_src

* Default-text-scale

Text-scale-mode but Emacs-wide
#+begin_src emacs-lisp
  (use-package default-text-scale)
#+end_src

* Dimmer

Dim inactive buffers
#+begin_src emacs-lisp
  (use-package dimmer
    :disabled ; Not sure if I should keep
    :hook (after-init . dimmer-mode)
    :custom
    (dimmer-fraction 0.27)
    :config
    (dimmer-configure-which-key) ; Exclude which-key buffer
    (add-to-list 'dimmer-buffer-exclusion-regexps "^ \\*org-roam\\*$") ; Exclude org-roam-buffer
    )
#+end_src

* Goto-line-preview

Preview line before you jump to it with =M-x goto-line=
#+begin_src emacs-lisp
  (use-package goto-line-preview
    :config
    (general-define-key [remap goto-line] 'goto-line-preview) ; Remap
    )
#+end_src
* Ace-link

Click links easier
#+begin_src emacs-lisp
  (use-package ace-link
    :config

    (general-define-key
     :kemaps '(Info-mode helpful-mode help-mode woman-mode eww-mode compilation-mode mu4e-view-mode custom-mode-map)
     "M-o" 'ace-link
     )
    )
#+end_src
* Ace-jump

Quickly jump to characters
#+begin_src emacs-lisp
  (use-package ace-jump-mode
    :custom
    (ace-jump-mode-gray-background nil) ; Don't make text's background gray
    (ace-jump-mode-scope 'visible) ; Everything visible
    (ace-jump-mode-case-fold t) ; Ignore case
    :config

    (general-define-key
     "M-a" '(ace-jump-mode :which-key "Ace-jump")
     )
    )
#+end_src
* Keyfreq

See a heatmap of your keypresses
#+begin_quote
Use =keyfreq-show= to see how many times you used a command. Use =keyfreq-html= to get the original rendered HTML page. Use =keyfreq-html-v2= to get the keyboard heat map.
#+end_quote
#+begin_src emacs-lisp
  (use-package keyfreq
    :straight (keyfreq :type git :host github :repo "KirmTwinty/keyfreq")
    :hook ((after-init . keyfreq-mode)
           (after-init . keyfreq-autosave-mode))
    :custom
    (keyfreq-folder (concat no-littering-var-directory "keyfreq"))
    ;; Commands not to be logged
    (keyfreq-excluded-commands '(self-insert-command 
                                 org-self-insert-command
                                 ;; forward-char
                                 ;; backward-char
                                 ;; previous-line
                                 ;; next-line
                                 ))
    )
#+end_src
